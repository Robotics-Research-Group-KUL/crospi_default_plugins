{
    "$schema": "http://json-schema.org/draft-06/schema",
    "$id":"VectorInputHandler.schema.json",
    "type":"object",
    "properties":{
        "is-VectorInputHandler" : {
            "description":"To indicate that this describes a Vector inputhandler which reads a Vector3 or a Point message type from a topic and converts it into a vector etasl expression",
            "type":"boolean",
            "const": true
        }
    },
    "required":["is-VectorInputHandler"],
    "additionalProperties": true,
    "dependencies":{
        "is-VectorInputHandler":{
          "required":["topic-name", "msg_type", "number_of_tries", "depth","default_vector", "when_unpublished", "varname"],
          "properties":{
                "topic-name" : {
                    "description":"name of the topic to subscribe to",
                    "type":"string"
                },
                "msg_type" : {
                    "description":"name of the topic to subscribe to",
                    "enum":["geometry_msgs/Vector3", "geometry_msgs/Point"]
                },
                "number_of_tries" : {
                    "description":"the number of times unsuccesfully initialize() can be called before throwing an error",
                    "type":"number",
                    "default": 10
                },
                "depth" : {
                    "description":"Depth of the topic queue (i.e. buffer size storing incoming messages). Check ROS2 QoS policies for more information",
                    "type":"number",
                    "default": 1
                },
                "feedforward_input_topic" : {
                    "description":"(optional). Only use if the vector is a position (and not a velocity) vector. If set, the inputhandler will read from the specified topic of type geometry_msgs/Vector and will be used as feedforward (i.e. time derivative of the vector, if the vector is at a position level)",
                    "type":"string",
                    "default": "/etasl/feedforward/velocity_of_vector"
                },
                "default_vector" : { 
                    "description": "Default vector used in case that the topic defined in topic-name is not yet publishing",    
                    "$ref":"https://gitlab.kuleuven.be/rob-expressiongraphs/ros2/etasl_json_schemas/raw/main/schemas/vector.json",
                    "default": {
                        "x":0, 
                        "y":0, 
                        "z":0
                    },
                    "examples": [
                        [
                            {
                                "origin": {"x":0, "y":0, "z":0},
                                "orientation": {"roll":0, "pitch":0, "yaw":0}
                            }
                        ]
                    ]
                },
                "when_unpublished" : {
                    "description": "Defines the behavior of the node when nothing has been published to the topic defined in topic-name during activation time of the node",
                    "enum": ["use_default", "throw_error"],
                    "oneOf": [
                        {
                            "type": "string", 
                            "const": "use_default",
                            "title": "Use default value",
                            "description": "Uses the defined default value in the default_vector field while nothing has been published to the subscribed topic defined in topic-name. An INFO message will be logged."
                        },
                        {
                            "type": "string", 
                            "const": "throw_error",
                            "title": "Throw error",
                            "description": "Throws an error if nothing has been published to the subscribed topic defined in topic-name at the time of activation of the node, preventing its activation. "
                        }
                    ] 
        
                },
                "varname" : {            
                    "description":"Name of the expression variable in the task specification with createInputChannelFrame. The data coming from the topic will be available in the task specification through this variable",
                    "type":"string",
                    "examples": [
                        "my_input_frame",
                        "my_target_frame"
                    ]
                }
          }
        }
      }
}